import { Button, Input, Page, f7, useStore } from "framework7-react";
import React, { useEffect, useState } from "react";
import { Controller, useForm } from "react-hook-form";
import { yupResolver } from "@hookform/resolvers/yup";
import * as yup from "yup";
import {
  ArrowLeftIcon,
  EyeIcon,
  EyeSlashIcon,
} from "@heroicons/react/24/outline";
import AuthAPI from "../../api/Auth.api";
import { useMutation } from "react-query";
import store from "../../js/store";
import DeviceHelpers from "../../helpers/DeviceHelpers";
import PromHelpers from "../../helpers/PromHelpers";
import SubscribeHelpers from "../../helpers/SubscribeHelpers";
import KeyboardsHelper from "../../helpers/KeyboardsHelper";
import Dom7 from "dom7";
import StorageHelpers from "../../helpers/StorageHelpers";

const schemaLogin = yup
  .object({
    USN: yup.string().required("Vui lòng nhập tài khoản."),
    PWD: yup.string().required("Vui lòng nhập mật khẩu."),
  })
  .required();

function LoginPage({ f7router }) {
  const [hiddenPassword, setHiddenPassword] = useState(true);

  let Brand = useStore("Brand");

  const { control, handleSubmit, setError, setValue } = useForm({
    defaultValues: {
      USN: "",
      PWD: "",
    },
    resolver: yupResolver(schemaLogin),
  });

  useEffect(() => {
    StorageHelpers.get({
      keys: ["_historyU", "_historyP"],
      success: ({ _historyU, _historyP }) => {
        setValue("USN", _historyU || "");
        setValue("PWD", _historyP || "");
      },
    });
  }, []);

  const loginMutation = useMutation({
    mutationFn: (body) => AuthAPI.login(body),
  });

  let onSubmit = (values) => {
    DeviceHelpers.get({
      success: ({ deviceId }) => {
        loginMutation.mutate(
          { ...values, DeviceID: deviceId },
          {
            onSuccess: ({ data }) => {
              if (data && data?.acc_type && data?.acc_type !== "M") {
                if (data?.Status !== -1) {
                  if (data.ID === 1 || data?.DeviceIDs === deviceId) {
                    PromHelpers.SEND_TOKEN_FIREBASE().then(
                      ({ token, error }) => {
                        if (!error) {
                          var bodyFormData = new FormData();
                          bodyFormData.append("token", token);

                          AuthAPI.sendTokenFirebase({
                            ID: data.ID,
                            Type: data.acc_type,
                            bodyFormData,
                          }).then(() =>
                            store.dispatch("setAuth", data).then(() => {
                              f7router.navigate("/home/");
                              StorageHelpers.set({
                                data: {
                                  _historyU: values.USN,
                                  _historyP: values.PWD,
                                },
                              });
                            })
                          );
                        } else {
                          SubscribeHelpers.set(data).then(() =>
                            store.dispatch("setAuth", data).then(() => {
                              f7router.navigate("/home/");
                              StorageHelpers.set({
                                data: {
                                  _historyU: values.USN,
                                  _historyP: values.PWD,
                                },
                              });
                            })
                          );
                        }
                      }
                    );
                  } else {
                    setError("USN", {
                      type: "Server",
                      message:
                        "Tài khoản của bạn đang đăng nhập tại thiết bị khác.",
                    });
                  }
                } else {
                  setError("USN", {
                    type: "Server",
                    message: "Tài khoản của bạn đã bị vô hiệu hoá.",
                  });
                }
              } else {
                setError("USN", {
                  type: "Server",
                  message:
                    data?.error === "Yêu cầu đăng nhập"
                      ? "Tài khoản hoặc mật khẩu không hợp lệ."
                      : data?.error,
                });
                setValue("PWD", "");
              }
            },
            onError: (err) => {
              console.log(err);
            },
          }
        );
      },
      fail: (err) => console.log(err),
    });
  };

  const onToBack = () => {
    store.dispatch("setBrand", null).then(() => f7router.navigate("/brand/"));
  };

  return (
    <Page
      noNavbar
      noToolbar
      noSwipeback
      className="bg-white"
      onPageInit={() => f7.panel.close(Dom7("#panel-app"))}
      onPageBeforeIn={() => PromHelpers.STATUS_BAR_COLOR()}
    >
      <div className="flex flex-col h-full page-scrollbar pb-safe-b">
        <div className="pt-safe-t">
          <div className="relative flex items-center justify-center h-12 px-4">
            <div
              className="absolute left-0 flex items-center justify-center w-12 h-full"
              onClick={onToBack}
            >
              <ArrowLeftIcon className="w-6" />
            </div>
            <div className="text-base font-bold">{Brand?.Name}</div>
          </div>
        </div>
        <div className="flex flex-col justify-between h-[calc(100%-48px)]">
          <div className="flex flex-col items-center justify-center px-4 grow">
            <div className="mb-4 text-center">
              <div className="mb-1 text-2xl font-bold">Xin chào.</div>
              <div className="w-10/12 mx-auto font-light">
                Để tiếp tục sử, vui lòng đăng nhập tài khoản của bạn tại
                <span className="pl-2 font-semibold">{Brand?.Name}</span>.
              </div>
            </div>
            {/* <div>
              <svg
                className="w-[250px]"
                xmlns="http://www.w3.org/2000/svg"
                xmlnsXlink="http://www.w3.org/1999/xlink"
                viewBox="0 0 485.73 271.78"
              >
                <defs>
                  <style
                    dangerouslySetInnerHTML={{
                      __html:
                        ".cls-1{fill:none;}.cls-2{fill:#f2f6fb;}.cls-3{fill:#1d5b45;}.cls-4{fill:#12382a;}.cls-5{fill:#2c8443;}.cls-6{fill:#6eaf45;}.cls-7{fill:#e1e6f4;}.cls-8{fill:#6776e8;}.cls-9{fill:#c3c9e0;}.cls-10{clip-path:url(#clip-path);}.cls-11{fill:#5350cd;}.cls-12{fill:#67a2e6;}.cls-13{fill:#4167aa;}.cls-14{fill:#343d5b;}.cls-15{fill:#8697bf;}.cls-16{fill:#fff;}.cls-17{fill:#9ea9cc;}.cls-18{fill:#ffc655;}.cls-19{fill:#ffaa56;}.cls-20{fill:#ff8a57;}.cls-21{fill:#ffe461;}.cls-22{fill:#252549;}.cls-23{fill:#ffbf9f;}.cls-24{fill:#3b345b;}.cls-25{fill:#5d3c2e;}.cls-26{fill:#26242f;}.cls-27{fill:#7972d3;}.cls-28{fill:#678ee7;}.cls-29{fill:#ff9b80;}.cls-30{fill:#696b84;}.cls-31{fill:#8186aa;}.cls-32{fill:#535777;}.cls-33{fill:#e25247;}.cls-34{fill:#b2322b;}.cls-35{fill:#67afe5;}",
                    }}
                  />
                  <clipPath id="clip-path" transform="translate(-7.13 -64.11)">
                    <path
                      className="cls-1"
                      d="M236.86,82.2h0a7.77,7.77,0,0,0-5.29,7.38v7.81H399.86V93.21H239.09A2.24,2.24,0,0,1,236.86,91V82.2"
                    />
                  </clipPath>
                </defs>
                <g id="Layer_2" data-name="Layer 2">
                  <path
                    className="cls-2"
                    d="M332.82,64.11c-32.58,0-78.78,8.25-128.22,24.26C115.82,117.12,50.18,160,58,184.13,61.46,194.82,78.76,200,104.67,200c5.34,0,11-.22,17.08-.66.46-.6.94-1.23,1.43-1.89,6.34-8.54,11.64-12,16.46-12.26h0l.7,0a14.65,14.65,0,0,1,7.92,2.67c2.25,1.46,5.69,4.05,9.36,6.91l.72-.13c-.39-5.26-.55-10-.19-12.44a5.94,5.94,0,0,1,1-2.48c-.42-3.24,4.68-2.33,1.9-5.45-3.34-3.76,1.26-7.39,3.77-10.31s.48-5.85.9-13,6-17.55,16-21.45a14.32,14.32,0,0,1,5.22-1c7.81,0,14.08,6.13,14.08,6.13s7.17,1.67,7.8,8.08S205,158,203.57,162.1s1.25,3.69.87,6.55-2.41,2.78-.46,6.61a4,4,0,0,1,0,3.8,5.67,5.67,0,0,1,1.59,1.91c.18.4.54,1.36,1,2.7q12.31-3.39,25-7.46V89.58h0v0h0v0h0v0h0v-.05h0v0h0v0h0A7.8,7.8,0,0,1,237.69,82h0a9.06,9.06,0,0,1,1.49-.18H379.94A13.72,13.72,0,0,0,379.5,80C376,69.33,358.74,64.11,332.82,64.11"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-2"
                    d="M217.59,221.71h0L216.41,229a31.24,31.24,0,0,1-3.79-.71c-.32-.11-.84-1.29-1.37-2.79q-4.14,2.55-7.9,5.11c0,.56,0,1.09.05,1.58h0c0,.79.07,1.47.09,2,.23,0,.47,0,.71,0a6.85,6.85,0,0,1,3.87,1,27.73,27.73,0,0,1,3.14,2.67l3.64.82,2.74-16.9m184.06-53.56h-1.79v17.36h0a7.8,7.8,0,0,1-7.8,7.8H279.79A429.77,429.77,0,0,0,235,212.39h30.73a1.13,1.13,0,0,1,1.11,1.31l-5.41,31-.22,1.26a1.1,1.1,0,0,1-1.09.91H248.72l3.19,1.82,14.9,22.7h0s5.5,1.94,11.54,4.32h0c2.31.9,4.7,1.86,6.89,2.81,11.84-2.81,24.14-6.25,36.68-10.31,75.63-24.49,131.12-62.34,123.93-84.54-3.37-10.39-19.85-15.51-44.2-15.51"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-2"
                    d="M111.31,211.42q-4.57,1.31-9.28,2.82c-37.84,12.25-65.79,30.57-62.44,40.93,1.5,4.61,8.94,6.86,20.09,6.86a139.54,139.54,0,0,0,25.15-2.7,104.36,104.36,0,0,1,11.6-27.44c6.9-11.11,11.06-16.22,14.88-20.47"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-2"
                    d="M423.77,124.48A69,69,0,0,0,402.9,128c-1,.33-2,.68-3,1.05v34.58a74.46,74.46,0,0,0,13.58-3.07C432.75,154.34,446,142,443.12,133c-1.79-5.54-9.32-8.51-19.35-8.51"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-2"
                    d="M413.47,252.84c-10.48,0-24.42,2.4-39.16,7.17-28.81,9.33-49.8,24.18-46.89,33.17,1.42,4.39,8.27,6.57,18.26,6.57,10.49,0,24.42-2.4,39.17-7.18,28.8-9.32,49.8-24.17,46.88-33.16-1.42-4.39-8.27-6.57-18.26-6.57"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-3"
                    d="M401.31,175.6a25.58,25.58,0,0,0,12.53-17.44c2.35-12.42,5.39-27.61,16.94-17.07s1.06,40.66-16.94,48.07l-18,7.42S395.84,176.6,401.31,175.6Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-4"
                    d="M389.69,194.79s17.76-11.21,27.45-21.75,7.32-24.19,7.32-24.19a29.38,29.38,0,0,1-4.93,24.5C410.73,185.44,389.69,194.79,389.69,194.79Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M396.79,172.48A15.39,15.39,0,0,0,404.46,162c1.44-7.43,3.29-16.53,10.35-10.22s.65,24.35-10.35,28.79l-11,4.44S393.45,173.08,396.79,172.48Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-3"
                    d="M389.69,184s10.86-6.71,16.78-13A18.11,18.11,0,0,0,411,156.46a17.26,17.26,0,0,1-3,14.67C402.55,178.37,389.69,184,389.69,184Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-6"
                    d="M404.73,188.5s8.92-5,25.78-15.61,20.2-16.77,19.08-6.85-5.65,20.69-22.33,27.28S388,198.5,404.73,188.5Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M404.46,195.46s6.13-1.22,19.85-11,16.23-12,16.23-12-14.27,12.22-21,17A37.72,37.72,0,0,1,404.46,195.46Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M396.79,120.32S413,75.93,429.39,84s-36.5,47-36.5,47Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-3"
                    d="M393.4,129.64s27.35-36.15,26.1-34.76S400.88,125.53,393.4,129.64Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-6"
                    d="M391.78,133.33s24.24-31.21,34-22.85S405.29,135,396.24,136.81,391.78,133.33,391.78,133.33Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M395.82,134.72s3.81-5.22,13.33-11.6S422,116.47,422,116.47,401.11,128.73,395.82,134.72Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M66.71,324.29s-9.62,3.25-14.36-4.38.2-9.42-7.7-12.18-9.83-4.49-11.42-10-9.82-4.22-12.95-10.71,1.54-4.43-4.81-13.2S5.14,260,8.17,257.81s9.32-2.19,13.64,4.39,8,10.26,13.19,10.05,5.67,11.85,12,11.6,11.51,2.8,13.63,8.73S70.85,297,74.85,303.36A63.08,63.08,0,0,1,81,316.77Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-3"
                    d="M21.05,270.56l.66.74c2.73,3.05,13.63,15.08,27,27.55,15.5,14.45,26.75,20.82,26.75,20.82l-1.8.95s-8-4.29-23.31-18.65A383.82,383.82,0,0,1,21.05,270.56Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-6"
                    d="M65.59,316.64S52.54,316,50.5,304.59s4.71-11.17-3.44-18.21-9.62-10-8.92-17.34-9.75-9.7-10.42-18.94,4-4.57.53-18.07-5.77-21.54-1.12-22.66,12.18,1.8,14.23,11.72,4.68,16.06,11,18.28,1.15,16.86,8.83,19.55,12.45,8.81,12.17,16.92,10.15,10.09,11.9,19.63a81.79,81.79,0,0,1,.95,18.95Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M36.48,230.73l.44,1.2c1.82,4.95,9.14,24.5,19.23,45.76,11.68,24.62,22.1,37.58,22.1,37.58l-2.6.28s-7.52-8.92-19-33.36A493.69,493.69,0,0,1,36.48,230.73Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M88.16,314.21s-10.75-2.15-8.92-9.6,1.68-13.23-2.29-17.36-6.73-10-4.56-17.31,1.53-8.73-1.73-16.11-7.08-18.57,1.85-21S83.57,250.1,87.71,255s13.61,6.89,14.86,16.07-1.79,12.34,6.6,17,5.85,19.66,3.4,23.45Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-3"
                    d="M79.35,250.66S90.29,289.75,94.73,299s6.74,13.77,6.74,13.77l-2.67.29S81,267.06,79.35,250.66Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-7"
                    d="M399.86,89.58v95.94a7.8,7.8,0,0,1-7.8,7.8H239.37a7.8,7.8,0,0,1-7.8-7.8V89.58a7.8,7.8,0,0,1,7.8-7.8H392.06a7.8,7.8,0,0,1,7.8,7.8"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-8"
                    d="M399.86,89.58v7.81H231.57V89.58a7.77,7.77,0,0,1,5.29-7.38,7.68,7.68,0,0,1,2.51-.42H392.06a7.8,7.8,0,0,1,7.8,7.8"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M237.7,103.24v84.33a2,2,0,0,0,2,2h74.11a2,2,0,0,0,1.95-2V187a2,2,0,0,1,2-2h82.2v.48a7.8,7.8,0,0,1-7.8,7.8H239.37a7.8,7.8,0,0,1-7.8-7.8V98.17a1.92,1.92,0,0,1,1.56-.78H399.86v3.9H239.65a2,2,0,0,0-2,1.95"
                    transform="translate(-7.13 -64.11)"
                  />
                  <g className="cls-10">
                    <rect
                      className="cls-11"
                      x="224.43"
                      y="18.09"
                      width="168.29"
                      height="15.19"
                    />
                  </g>
                  <path
                    className="cls-12"
                    d="M348.38,84.42H263a1.61,1.61,0,1,0,0,3.21h85.38a1.61,1.61,0,0,0,0-3.21"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-12"
                    d="M381.77,84H357.3a1.74,1.74,0,0,0-1.74,1.74v.14a1.73,1.73,0,0,0,1.74,1.74h24.47a1.73,1.73,0,0,0,1.74-1.74v-.14A1.74,1.74,0,0,0,381.77,84"
                    transform="translate(-7.13 -64.11)"
                  />
                  <rect
                    className="cls-13"
                    x="296.69"
                    y="59.38"
                    width="19.78"
                    height="17.18"
                    rx="2.42"
                  />
                  <path
                    className="cls-14"
                    d="M314.78,132.58,316,136h-4.62l1.2-3.47a2.31,2.31,0,1,1,3.42-2A2.34,2.34,0,0,1,314.78,132.58Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-15"
                    d="M321.36,123.48H318v-3.87a4.39,4.39,0,0,0-8.78,0v2h-3.34v-2a7.74,7.74,0,0,1,15.47,0Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <rect
                    className="cls-16"
                    x="265.39"
                    y="87.7"
                    width="81.17"
                    height="12.07"
                    rx="2.42"
                  />
                  <rect
                    className="cls-16"
                    x="265.39"
                    y="105.35"
                    width="81.17"
                    height="12.07"
                    rx="2.42"
                  />
                  <path
                    className="cls-9"
                    d="M343.71,159.52h-61a1.53,1.53,0,1,1,0-3.06h61a1.53,1.53,0,1,1,0,3.06Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M294.3,175.94a1.56,1.56,0,0,1-3.11,0,1.56,1.56,0,1,1,3.11,0Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M300.16,175.94a1.56,1.56,0,1,1-1.56-1.56A1.55,1.55,0,0,1,300.16,175.94Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M306,175.94a1.56,1.56,0,1,1-1.56-1.56A1.55,1.55,0,0,1,306,175.94Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M311.86,175.94a1.56,1.56,0,1,1-1.56-1.56A1.55,1.55,0,0,1,311.86,175.94Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M317.71,175.94a1.56,1.56,0,1,1-1.56-1.56A1.55,1.55,0,0,1,317.71,175.94Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M323.56,175.94a1.56,1.56,0,1,1-1.55-1.56A1.55,1.55,0,0,1,323.56,175.94Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M329.41,175.94a1.56,1.56,0,0,1-3.11,0,1.56,1.56,0,1,1,3.11,0Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M335.26,175.94a1.56,1.56,0,0,1-3.11,0,1.56,1.56,0,1,1,3.11,0Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-7"
                    d="M492.87,322.24c0,7.54-100.47,13.65-224.41,13.65S44.05,329.78,44.05,322.24s100.47-13.65,224.41-13.65S492.87,314.7,492.87,322.24Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-17"
                    d="M311,318.84c0,4.8-47.73,8.69-106.6,8.69s-106.6-3.89-106.6-8.69,47.73-8.68,106.6-8.68S311,314.05,311,318.84Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-17"
                    d="M445.83,316.47c0,2.2-22.7,4-50.71,4s-50.71-1.78-50.71-4,22.7-4,50.71-4S445.83,314.27,445.83,316.47Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-18"
                    d="M291.23,301.34c-3.4,15.14-23.44,19.51-70,20.34s-95.85-1.39-122.88-13.08-15.32-55.18-1.95-76.71,16.44-20.54,26.75-34.4c6.34-8.54,11.64-12,16.46-12.26a14.21,14.21,0,0,1,8.62,2.65c7.24,4.69,26.66,21,26.66,21s60.83,57.39,86.47,64.36c13.69,3.72,22.24,7.18,26.72,11.89,3.9,4.11,4.7,9.2,3.12,16.25"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-19"
                    d="M172,272.87a3.86,3.86,0,0,0-.61.05c-1.19.22-4.17.62-7.67,1a143.16,143.16,0,0,0,14.91,2.63c.55-1.17-4-3.7-6.63-3.7m-12.18-63.33c-4.85,1.9-14.78,9-22.56,35.09-4.41,14.81,5.71,22.95,20.12,27.56,1.93-.35,3.82-.64,5.37-.81,6.69-.7-2.5-.69-11.42-6.54s-4.73-18-4.73-18c2.5,11.28,5.85,10.18,9.75,12.47a2.94,2.94,0,0,0,1.3.5c1.81,0-.18-5.56,1.51-15.2a41.25,41.25,0,0,1,3.6-10.49c0-.8.19-1.82.27-3.06,0-.7.07-1.66.07-2.69,0-2.86-.14-6.31-.15-6.7v0h0l-.56-.19c-.56-.17-.84-.08-1.22-1.8-.13-.63-.71-4.76-1.35-10.12"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-20"
                    d="M291.23,301.34c-3.4,15.14-23.44,19.51-70,20.34s-95.85-1.39-122.88-13.08-15.32-55.18-1.95-76.71,16.44-20.54,26.75-34.4c6.34-8.54,11.64-12,16.46-12.26-5.63,3.84-15.31,11.67-18.41,21.94-4.46,14.76-11.51,23.57-22.57,33.43s-12,40.12-2.23,52.38,40.4,18.67,79.69,22.57,105.07,1.56,109.1-13.71a107.12,107.12,0,0,0,2.89-16.75c3.9,4.11,4.7,9.2,3.12,16.25"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-20"
                    d="M146.59,246.86s-4.18,12.13,4.73,18,18.11,5.84,11.42,6.54-19.78,3.77-14.2,3.77,19.84-1.67,22.84-2.23,10,3.62,6.13,4.18-5.57,5.3-5.57,5.3,4.8-5.47,15.08-2.88,8.63.62,14.47,5,9.46,6,5.56,2-7.22-6.83-5.56-5.44c.71.6,5.57.58,11.87.56,8.42,0,19.41-.05,26.47,1.39,12.35,2.53,25.17,14.61,25.17,14.61l-13.09-17.67s-84.41-18-87.77-26.37,6.69-32.42,6.69-32.42-9.71,12.24-11.68,23.53,1.09,17-2.81,14.7-7.25-1.19-9.75-12.47"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-21"
                    d="M101.72,255.65s-16,24.5,16.79,39.18,55.56,12.83,56.36,11.71,4.39-4.22-1.6-9S125.7,285.74,120.11,275,112.12,247.47,101.72,255.65Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-21"
                    d="M184.86,300.36s51.61-1.62,50.78,4.7-.72,7.43-18.76,7.43S172.07,305.7,184.86,300.36Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-22"
                    d="M201.06,134.72s-9.27-9-19.3-5.15-15.6,14.35-16,21.45,1.6,10-.9,13-7.11,6.55-3.77,10.31-4.73,1.67-.83,8,40.82-.28,40.82-.28,4.87-2.93,2.92-6.76.09-3.76.46-6.61-2.27-2.44-.87-6.55,5.92-12.89,5.29-19.3-7.8-8.08-7.8-8.08"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-23"
                    d="M176,172.34s1.38.07,1.24-1.67-.9-.84,1.75-5.09,1.88-4.74.9-7.1,3.1-4,5.52-7.46,5.42-7.66,8-10,5-2.44,6.41-1.74a3.83,3.83,0,0,1,1.81,2.23s-.34,15.11-3.48,20.69S192.7,167.88,190,167c0,0-1,4.81-.42,6.62s6.62,4.25,3.14,9.2-12.86,7.29-16.16,1.81-.55-12.33-.55-12.33"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-23"
                    d="M287.15,293.75s8.33,1.86,11.34,3.4,7,2.07,8.79-.56,1.49-4.45,4.5-6.85,9.78-6,8.71-8.51-3.35-2-5.26-.09-10.72,3.45-12.34,4.23-7.11.83-8.26.83-6.69-2-6.69-2l-.79,9.55"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-23"
                    d="M276.24,305.8s6.87,5.11,7.8,8.36,3.25,6.5,6.41,6,4.27-2,8.08-1.4,11.05,3.07,12.17.56-.84-3.81-3.53-3.9-9.85-5.48-11.52-6.13a52.7,52.7,0,0,1-8.5-5c-.79-.83-3.39-4.45-3.39-4.45Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-24"
                    d="M291.23,295.18a10,10,0,0,1-1.15,2.13c-1.08,1.21-6.53-2.32-6.82-2.51l0,0c.38.39,3.34,3.58,3.87,5.53h0c.51,2.11-11.28,7.79-13.51,8.22s-18.39-22.16-18.39-22.16-18.39-5.57-20.48-6.54c-1-.47-10.14-.48-19.27-.38h0c-9.77.12-19.58.38-19.58.38s-4.87-1.67-9.75-3.62-23.21-7.38-23.21-7.38S159.4,266.1,159.4,255s6.13-22,6.13-22l9.23.67,26.73,1.93L247,245.9l4.88,2.78,14.9,22.7s5.5,1.94,11.54,4.32c7.13,2.78,15,6.17,15.63,7.68.85,2.12-1.23,8.4-2.75,11.8"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-25"
                    d="M254.43,286.18l.82.26h0l-.81-.25m-14.6-4.54.24.07-.19-.06h0"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-26"
                    d="M196.6,255.65s19.92,5.71,31.21,7.94,15,7,16,13.23c.66,4.29-1.45,5-2.85,5a4.48,4.48,0,0,1-1.1-.13l.19.06,14.36,4.47.81.25c-.35-.46-16.44-21.18-17.54-22.29s-41.1-8.49-41.1-8.49"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-26"
                    d="M266.81,271.38l16.44,23.41h0c.25.16,4.26,2.76,6.1,2.76a1,1,0,0,0,.72-.25,10,10,0,0,0,1.15-2.13,19.08,19.08,0,0,1-6.58-5.33c-2.64-3.72-4.8-9.39-6.3-14.15h0c-6-2.38-11.54-4.32-11.54-4.32"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-26"
                    d="M164,236.11c-1.82,4-4.59,11.36-4.59,18.85,0,11.14,3.54,13.93,3.54,13.93s18.33,5.42,23.21,7.38,9.75,3.62,9.75,3.62,9.81-.26,19.58-.38c-15.52-2-36.29-9.65-42.38-21.63-3.06-6-1.59-14.43.63-21.27-4.67-.14-8.55-.31-9.74-.5"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-23"
                    d="M209.19,218.84s2.5,9.13,3.43,9.45a31.24,31.24,0,0,0,3.79.71l1.81-11.15L217,216.17s-9.06-1.62-7.8,2.67"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-8"
                    d="M217.7,216.15c.05.44-.9.93-2.2,1.38h0c-2.54.85-6.43,1.49-7,1.27-.84-.36-3.69-10.39-3.69-10.39s0,.15-.07.43v0c0,.24-.1.59-.15,1-.25,1.79-.69,5-1.11,8.93-.16,1.59-.24,3.38-.25,5.17,0,3,.09,6,.16,8.22.07,1.37.12,2.38.09,2.84-.06,1.6-4,2.23-12.54,2s-25.74-.54-27.23-1-.88-2.18-.7-5-.08-9.43-.08-9.43l-.56-.19c-.56-.17-.84-.08-1.22-1.8s-4.12-29.9-3-37.44S176,172.34,176,172.34a46.76,46.76,0,0,0,3.2,4.46c1.67,2,8.08,5.78,8.63,5.78s1.67-.91,2.72-4a4.73,4.73,0,0,0-1-5,21.08,21.08,0,0,1,5,.84c3.06.84,9.68,3.62,10.94,6.47s12,33.86,12.18,35.18"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-27"
                    d="M204.6,209.87c-.25,1.79-.69,5-1.11,8.93-.16,1.59-.24,3.38-.25,5.17l1.36-14.1"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-11"
                    d="M172.13,193.32s2.23,22.48,2.23,24.24c0,1.46-.76,1.59-1,1.59h-.1c0,.18.66,6.6,1.58,7s25.08,8.27,26.19,8.27c.47,0,1.4-.15,2.48-.2,0-.52-.05-1.2-.09-2h0a146.47,146.47,0,0,1-15.58-3.89c-8.26-2.75-13.37-5.44-12.73-7.67.47-1.56,7.13-2.12,13.09-2.12,2.54,0,4.95.1,6.7.27a11,11,0,0,1,8.36,5.19h0c0-1.79.09-3.58.25-5.17.42-3.89.86-7.14,1.11-8.93h0l.69-7.16s-2.61,4.18-6.23,5.38a32.94,32.94,0,0,1-8.64.87c-4.64,0-9.72-.54-12.16-1.88-4.37-2.42-6.13-13.76-6.13-13.76"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-11"
                    d="M162.94,221.69c0,.39.15,3.84.15,6.7,0,1,0,2-.07,2.69-.09,1.36-.28,2.46-.28,3.29s.21,1.44,1,1.68c1.17.36,12,.64,20.75.84-4.17-.73-8.57-1.49-11.41-2.33-6.32-1.85-7.71-3-8.46-4.93a64.83,64.83,0,0,1-1.66-7.94"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-23"
                    d="M162.93,221.65s2.51-.18,5.2-.65a17.55,17.55,0,0,0,5.11-1.85s.65,6.59,1.58,7,25.08,8.27,26.19,8.27,4.74-.84,7.06.74a57,57,0,0,1,6.39,5.93s.25,3.58-1.54,3.58-2.06-4-6.52-3.19c-1.77.33-3.65,1.1-5.47.7a16.68,16.68,0,0,1-5.4-2.65c-2.23-1.58-16.16-3.07-22.47-4.93s-7.71-3-8.46-4.93a65.43,65.43,0,0,1-1.67-8"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-11"
                    d="M201.49,189.92l3.8,12.79h0l-.54,6.13c.05-.28.07-.43.07-.43s2.85,10,3.69,10.39a1.2,1.2,0,0,0,.39,0,28.56,28.56,0,0,0,6.58-1.31l-3.23-.52c-3.18-.54-5-8.17-5-11.88s-5.41-14.53-5.75-15.21"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-28"
                    d="M174.51,178.28c-1,0-1.58.7-1.36,2.6,0,0,4.08,15.23,14,16.53a8.07,8.07,0,0,0,1.18.08c8.86,0,9.93-14,9.13-16.61-.39-1.27-.87-1.82-1.51-1.82s-1.63.69-2.85,1.82c-1.76,1.61-4.3,3.28-6.76,3.28a4.88,4.88,0,0,1-2.35-.59c-2.16-1.18-7.08-5.29-9.5-5.29"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-16"
                    d="M283.28,294.83c.38.39,3.34,3.58,3.87,5.53A58.3,58.3,0,0,1,283.28,294.83Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-29"
                    d="M190,167s-3.69-1.81-5.22-2.71a12.89,12.89,0,0,0-1.81-1s3.69,9.07,4.45,8.23A34.89,34.89,0,0,0,190,167Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-30"
                    d="M266.8,213.7l-5.41,31-.22,1.26a1.1,1.1,0,0,1-1.09.91h-67a1.11,1.11,0,0,1-1.12-1.1h0a1.12,1.12,0,0,1,1.12-1.12h19.8a1.11,1.11,0,0,0,1.11-.93L219,213.33a1.1,1.1,0,0,1,1.09-.94h45.65a1.13,1.13,0,0,1,1.11,1.31"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-31"
                    d="M242.9,228.29c0,1.57-.69,2.84-1.53,2.84s-1.54-1.27-1.54-2.84.69-2.83,1.54-2.83S242.9,226.73,242.9,228.29Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-32"
                    d="M221.41,212.39H220a1.1,1.1,0,0,0-1.09.94l-.73,4.52L218,219l-3.58,22.09L214,243.7a1.11,1.11,0,0,1-1.11.93h-19.8a1.12,1.12,0,0,0-1.12,1.12h0a1.11,1.11,0,0,0,1.12,1.1h67a1.1,1.1,0,0,0,1.09-.91l.22-1.26H218.68a2.23,2.23,0,0,1-2.19-2.6l4.92-29.7"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-20"
                    d="M439.14,276.63v6.72a1.11,1.11,0,0,1-1.11,1.12H359.82a1.11,1.11,0,0,1-1.11-1.12v-6.72a1.11,1.11,0,0,1,1.11-1.11H438A1.11,1.11,0,0,1,439.14,276.63Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-33"
                    d="M439.14,280.91v2.44a1.11,1.11,0,0,1-1.11,1.12H359.82a1.11,1.11,0,0,1-1.11-1.12v-6.72a1.11,1.11,0,0,1,1.11-1.11h4.1v3.16a2.23,2.23,0,0,0,2.22,2.23Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-33"
                    d="M371,284.47l-8.47,32.66a2.56,2.56,0,0,1-1.73,1.82,2.5,2.5,0,0,1-1.33.06,2.6,2.6,0,0,1-2-2.53,2.74,2.74,0,0,1,.07-.62L364.36,288l.86-3.5Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-34"
                    d="M371,284.47l-8.47,32.66a2.56,2.56,0,0,1-1.73,1.82c3.67-11.61,6.49-31,6.49-31h-2.9l.86-3.5Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-33"
                    d="M425.58,284.47l8.47,32.66a2.58,2.58,0,0,0,1.73,1.82,2.53,2.53,0,0,0,1.34.06,2.6,2.6,0,0,0,2-2.53,2.74,2.74,0,0,0-.07-.62L432.19,288l-.86-3.5Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-34"
                    d="M425.58,284.47l8.47,32.66a2.58,2.58,0,0,0,1.73,1.82c-3.67-11.61-6.49-31-6.49-31h2.9l-.86-3.5Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-3"
                    d="M390.11,269.11s-4.28-.46-4.46-3.25-1.58-2.23-3.16-2.13a2.13,2.13,0,0,1-2.32-2.7c.28-1.67-2.23-3.15-.74-3.9s2.6-.65,3.34.65,2.38,1.77,4.3,1,3-.42,2.48,1.72,2.52-.76,3.44,3.06S390.11,269.11,390.11,269.11Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-5"
                    d="M396.61,268.37s-3.7-4.16-2.51-6.41,3.26-.56,3.81-3.06,1.21-3.44,3.43-3,.84-3.43,3.81-2.78,2,3.06,0,4.46,2.14,3.34-.83,4.64-5,.19-3.88,2-.58,3.81-2,4.09S396.61,268.37,396.61,268.37Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-6"
                    d="M392.06,267.44s-3.53-1-2.42-4.08-3.53-3.07-2.41-5.48.18-3.26-.84-4,.56-2.69,2.83-1.76.33,4.55,3.21,5,3.25,2.14,2.6,3.62,3.06,1.86,2.88,4.37S392.06,267.44,392.06,267.44Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-9"
                    d="M403.48,270.87h0a5,5,0,0,1-.21,1.4,4.64,4.64,0,0,1-4.43,3.24H388.25a4.64,4.64,0,0,1-4.64-4.64h0a4.62,4.62,0,0,1,2.9-4.3,4.73,4.73,0,0,1,1.74-.34h10.59A4.64,4.64,0,0,1,403.48,270.87Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-17"
                    d="M403.27,272.28a4.64,4.64,0,0,1-4.43,3.24H388.25a4.64,4.64,0,0,1-4.64-4.64h0a4.62,4.62,0,0,1,2.9-4.3,4.09,4.09,0,0,1,.34,1.65,4.06,4.06,0,0,0,4.06,4.06Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <rect
                    className="cls-7"
                    x="311.83"
                    y="123.36"
                    width="92.68"
                    height="48.67"
                    rx="4.46"
                  />
                  <path
                    className="cls-8"
                    d="M411.65,191.93v3.53H319v-3.53a4.39,4.39,0,0,1,.7-2.41,4.46,4.46,0,0,1,3.75-2.05h83.77a4.44,4.44,0,0,1,4.46,4.46Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <rect
                    className="cls-9"
                    x="340.34"
                    y="142.41"
                    width="36.04"
                    height="4.55"
                    rx="1.21"
                  />
                  <rect
                    className="cls-15"
                    x="330.03"
                    y="150.86"
                    width="10.31"
                    height="12.91"
                    rx="1.21"
                  />
                  <rect
                    className="cls-15"
                    x="345.82"
                    y="150.86"
                    width="10.31"
                    height="12.91"
                    rx="1.21"
                  />
                  <rect
                    className="cls-15"
                    x="361.61"
                    y="150.86"
                    width="10.31"
                    height="12.91"
                    rx="1.21"
                  />
                  <rect
                    className="cls-15"
                    x="377.4"
                    y="150.86"
                    width="10.31"
                    height="12.91"
                    rx="1.21"
                  />
                  <path
                    className="cls-9"
                    d="M325.74,231.49h85.91v.19a4.46,4.46,0,0,1-4.46,4.46H323.42a4.45,4.45,0,0,1-4.45-4.46V195.76a1.33,1.33,0,0,1,.85-.3h90.44a1.4,1.4,0,0,1,0,2.79H325.74a1.39,1.39,0,0,0-1.39,1.39V230.1A1.39,1.39,0,0,0,325.74,231.49Z"
                    transform="translate(-7.13 -64.11)"
                  />
                  <path
                    className="cls-35"
                    d="M411,189.52H319.67a4.46,4.46,0,0,1,3.75-2.05h83.77A4.48,4.48,0,0,1,411,189.52Z"
                    transform="translate(-7.13 -64.11)"
                  />
                </g>
              </svg>
            </div> */}
          </div>
          <div className="pt-4 pb-4 pl-4 pr-4">
            <form onSubmit={handleSubmit(onSubmit)}>
              <div className="mb-4">
                <div className="mb-px">Tài khoản</div>
                <Controller
                  name="USN"
                  control={control}
                  render={({ field, fieldState }) => (
                    <Input
                      className="[&_input]:rounded [&_input]:placeholder:normal-case"
                      type="text"
                      placeholder="Nhập tài khoản"
                      value={field.value}
                      errorMessage={fieldState?.error?.message}
                      errorMessageForce={fieldState?.invalid}
                      clearButton={true}
                      onInput={field.onChange}
                      onFocus={(e) =>
                        KeyboardsHelper.setAndroid({ Type: "body", Event: e })
                      }
                    />
                  )}
                />
              </div>
              <div className="mb-4">
                <div className="mb-px">Mật khẩu</div>
                <Controller
                  name="PWD"
                  control={control}
                  render={({ field, fieldState }) => (
                    <div className="relative">
                      <Input
                        className="[&_input]:rounded [&_input]:lowercase [&_input]:placeholder:normal-case"
                        type={hiddenPassword ? "password" : "text"}
                        placeholder="Nhập mật khẩu"
                        value={field.value}
                        errorMessage={fieldState?.error?.message}
                        errorMessageForce={fieldState?.invalid}
                        onChange={field.onChange}
                        onFocus={(e) =>
                          KeyboardsHelper.setAndroid({ Type: "body", Event: e })
                        }
                      />
                      <div
                        className="absolute w-12 h-[47px] right-0 top-0 flex items-center justify-center"
                        onClick={() => setHiddenPassword(!hiddenPassword)}
                      >
                        {hiddenPassword ? (
                          <EyeSlashIcon className="w-4" />
                        ) : (
                          <EyeIcon className="w-4" />
                        )}
                      </div>
                    </div>
                  )}
                />
              </div>
              <Button
                type="submit"
                className="bg-app"
                fill
                large
                preloader
                loading={loginMutation.isLoading}
                disabled={loginMutation.isLoading}
              >
                Đăng nhập
              </Button>
            </form>
            <div className="my-4 relative text-center after:content-[''] after:absolute after:w-full after:h-[1px] after:bg-[#f2f2f7] after:left-0 after:top-3">
              <span className="relative z-10 px-4 bg-white text-muted">Or</span>
            </div>
            <Button
              type="button"
              className="text-white normal-case bg-black"
              fill
              large
              onClick={onToBack}
            >
              Chọn SPA
            </Button>
          </div>
        </div>
      </div>
    </Page>
  );
}

export default LoginPage;
